!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.sortedJSONStringify=t()}(this,function(){"use strict";function n(n){var t=n.replace(/,$/,""),e=t.replace(/^ */,"");return{indent:t.length-e.length,content:e}}function t(n){var t=n.map(function(n,t){return[t,(e=n[0].content,r=/^"(?:[^"\\]|\\.)*"/.exec(e)[0],JSON.parse(r))];var e,r});return t.sort(function(n,t){return n[1]===t[1]?0:n[1]<t[1]?-1:1}),t.map(function(t){return n[t[0]]})}var e=function(n,t){if(t=Math.floor(t),n=String(n),!(t>0)||""===n)return"";for(var e="",r=0;r<t;++r)e+=n;return e},r=function(n){return"number"==typeof n?e(" ",Math.min(n,10)):"string"==typeof n?n.substring(0,10):""},i=function(n){return n.replace(/^("(?:[^"\\]|\\.)*":) /,"$1")};return function(o,u,f){var c,a,p=r(f),s=JSON.stringify(o,u,1).split("\n").map(n);return function(n){for(var e=0;e<n.length;++e)if(/\{$/.test(n[e].content)){for(var r=n[e].indent,i=[],o=e+1;n[o].indent!==r;++o){var u=[n[o]];if(/[[{]$/.test(n[o].content)){for(++o;u.push(n[o]),n[o].indent!==r+1;++o);i.push(u)}else i.push(u)}if(!(i.length<=1)){var f=[].concat.apply([],t(i));[].splice.apply(n,[e+1,o-e-1].concat(f))}}}(s),a=p,(c=s).map(function(n,t){var r=n.content+(0===n.indent||c[t+1].indent!==n.indent?"":",");return a?e(a,n.indent)+r:i(r)}).join(a?"\n":"")}});

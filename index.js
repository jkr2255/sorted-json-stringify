!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):r.sortedJSONStringify=n()}(this,function(){"use strict";var r=function(r,n,e,u){var i=e+n,o=r.items.map(function(r){return t(r,n,i)}),f=n?"\n":"";return(u?"":e)+"["+f+o.join(","+f)+f+e+"]"},n=function(r,n,e,u){var i=e+n,o=n?"\n":"",f=function(r,n,e){var u=n?": ":":",i=r.map(function(r,n){return[n,JSON.parse(r.key)]});return i.sort(function(r,n){return r[1]===n[1]?0:r[1]<n[1]?-1:1}),i.map(function(i){var o=r[i[0]];return e+o.key+u+t(o.value,n,e,!0)})}(r.items,n,i);return(u?"":e)+"{"+o+f.join(","+o)+o+e+"}"};function t(t,e){var u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("scalar"===t.type)return(i?"":u)+t.value;if("array"===t.type)return r(t,e,u,i);if("object"===t.type)return n(t,e,u,i);throw new Error("unknown ast")}var e=function(r){for(var n=[];;){var t=f(r);if(!t)break;n.push(t)}return{type:"array",items:n}},u=function(r){var n=r.shift();if("}"===n)return!1;var t=/^("(?:[^\\"]|\\.)*"): (.+)$/.exec(n),u=t[1],f=t[2];return{key:u,value:f="["===f?e(r):"{"===f?i(r):o(f)}},i=function(r){for(var n=[];;){var t=u(r);if(!t)break;n.push(t)}return{type:"object",items:n}},o=function(r){return{type:"scalar",value:r}};function f(r){var n=r.shift();return"["===n?e(r):"{"===n?i(r):"]"!==n&&o(n)}var a=function(r){return"number"==typeof r?function(r,n){if(n=Math.floor(n),r=String(r),!(n>0)||""===r)return"";for(var t="",e=0;e<n;++e)t+=r;return t}(" ",Math.min(r,10)):"string"==typeof r?r.substring(0,10):""},c=function(r,n){return JSON.stringify(r,n,1).split(/,?\n */)};return function(r,n,e){var u=a(e);return t(f(c(r,n)),u)}});

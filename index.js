!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):r.sortedJSONStringify=n()}(this,function(){"use strict";var r=function(r,n,t,u){var i=t+n,o=r.items.map(function(r){return e(r,n,i)}),f=n?"\n":"";return(u?"":t)+"["+f+o.join(","+f)+f+t+"]"},n=function(r,n,t){var u=n?": ":":",i=r.map(function(r,n){return[n,(t=r.key,-1===t.indexOf("\\")?t.slice(1,-1):JSON.parse(t))];var t});return i.sort(function(r,n){return r[1]===n[1]?0:r[1]<n[1]?-1:1}),i.map(function(i){var o=r[i[0]];return t+o.key+u+e(o.value,n,t,!0)})},t=function(r,t,e,u){var i=e+t,o=t?"\n":"",f=n(r.items,t,i);return(u?"":e)+"{"+o+f.join(","+o)+o+e+"}"};function e(n,e){var u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("scalar"===n.type)return(i?"":u)+n.value;if("array"===n.type)return r(n,e,u,i);if("object"===n.type)return t(n,e,u,i);throw new Error("unknown ast")}var u=function(r){for(var n=[];;){var t=a(r);if(!t)break;n.push(t)}return{type:"array",items:n}},i=function(r){var n=r.shift();if("}"===n)return!1;var t=/^("(?:[^\\"]|\\.)*"): (.+)$/.exec(n),e=t[1],i=t[2];return{key:e,value:i="["===i?u(r):"{"===i?o(r):f(i)}},o=function(r){for(var n=[];;){var t=i(r);if(!t)break;n.push(t)}return{type:"object",items:n}},f=function(r){return{type:"scalar",value:r}};function a(r){var n=r.shift();return"["===n?u(r):"{"===n?o(r):"]"!==n&&f(n)}var c=function(r){return"number"==typeof r?function(r,n){if(n=Math.floor(n),r=String(r),!(n>0)||""===r)return"";for(var t="",e=0;e<n;++e)t+=r;return t}(" ",Math.min(r,10)):"string"==typeof r?r.substring(0,10):""},s=function(r,n){return JSON.stringify(r,n,1).split(/,?\n */)};return function(r,n,t){var u=c(t);return e(a(s(r,n)),u)}});

!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):r.sortedJSONStringify=n()}(this,function(){"use strict";var r=function(r,n,t,e){var u=t+n,o=r.items.map(function(r){return i(r,n,u)}),f=n?"\n":"";return(e?"":t)+"["+f+o.join(","+f)+f+t+"]"},n=function(r,n,t){var e=n?": ":":";return t+r.key+e+i(r.value,n,t,!0)},t=function(r,t,e){if(0===r.length)return[];if(1===r.length)return[n(r[0],t,e)];var i=r.map(function(r,n){return[n,(t=r.key,-1===t.indexOf("\\")?t.slice(1,-1):JSON.parse(t))];var t});return i.sort(function(r,n){return r[1]===n[1]?0:r[1]<n[1]?-1:1}),i.map(function(i){var u=r[i[0]];return n(u,t,e)})},e=function(r,n,e,i){var u=e+n,o=n?"\n":"",f=t(r.items,n,u);return(i?"":e)+"{"+o+f.join(","+o)+o+e+"}"};function i(n,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",u=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("scalar"===n.type)return(u?"":i)+n.value;if("array"===n.type)return r(n,t,i,u);if("object"===n.type)return e(n,t,i,u);throw new Error("unknown ast")}var u=function(){return function(r,n){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return function(r,n){var t=[],e=!0,i=!1,u=void 0;try{for(var o,f=r[Symbol.iterator]();!(e=(o=f.next()).done)&&(t.push(o.value),!n||t.length!==n);e=!0);}catch(r){i=!0,u=r}finally{try{!e&&f.return&&f.return()}finally{if(i)throw u}}return t}(r,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(r){for(var n=[];;){var t=v(r);if(!t)break;n.push(t)}return{type:"array",items:n}};var f=function(r){var n=r.shift();if("}"===n)return!1;var t=function(r){var n=r[r.length-1];if("{"===n||"["===n)return[r.slice(0,-3),n];var t=/^("(?:[^\\"]|\\.)*"): (.+)$/.exec(r);return[t[1],t[2]]}(n),e=u(t,2),i=e[0],f=e[1];return{key:i,value:"["===f?o(r):"{"===f?a(r):c(f)}},a=function(r){for(var n=[];;){var t=f(r);if(!t)break;n.push(t)}return{type:"object",items:n}},c=function(r){return{type:"scalar",value:r}};function v(r){var n=r.shift();return"["===n?o(r):"{"===n?a(r):"]"!==n&&c(n)}var s=function(r){return"number"==typeof r?function(r,n){if(n=Math.floor(n),r=String(r),!(n>0)||""===r)return"";for(var t="",e=0;e<n;++e)t+=r;return t}(" ",Math.min(r,10)):"string"==typeof r?r.substring(0,10):""},l=function(r,n){return JSON.stringify(r,n,1).split(/,?\n */)};return function(r,n,t){var e=s(t);return i(v(l(r,n)),e)}});
